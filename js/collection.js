!function(t){t(document).ready((function(){e.init()})),t(".engoj-collection-sidebar")&&History.Adapter.bind(window,"statechange",(function(){History.getState();if(!e.fillterClick){e.filterParams();var t=e.filterCreateUrl();e.filterGetContent(t),e.resetFilter()}e.fillterClick=!1}));var e={init:function(){this.initCollectionFilter(),this.initCollectionShow(),this.initCollectionSorting()},initReview:function(){},initToggle:function(){},filterCategories:function(){},fillterTagEvents:function(){t("body").delegate('.filter-tag a:not(".clear"), .filter-tag label',"click",(function(i){t(this).toggleClass("active");var a=t(this).text();t(this).closest(".dropdown").find(".dropdown-label").text(a),t(this).hasClass("active")||t(this).closest(".dropdown").find(".dropdown-label").text("");var r=[];if(Shopify.queryParams.constraint&&(r=Shopify.queryParams.constraint.split("+")),!window.filter_mul_choice&&!t(this).prev().is(":checked")){var n,l,o=t(this).parents(".filter-tag").find("input:checked");if(o.length>0)if(n=o.val())(l=r.indexOf(n))>=0&&r.splice(l,1)}(n=t(this).prev().val())&&((l=r.indexOf(n))>=0?r.splice(l,1):r.push(n));r.length?Shopify.queryParams.constraint=r.join("+"):delete Shopify.queryParams.constraint,e.filterAjaxClick(),i.preventDefault()}))},filterMapClearAll:function(){t("body").delegate("click",".refined-widgets a.clear-all",(function(t){delete Shopify.queryParams.constraint,delete Shopify.queryParams.q,e.filterAjaxClick(),t.preventDefault()})),t("body").delegate(".filter-block .clear","click",(function(i){var a=[],r=t(this).parent().parent();Shopify.queryParams.constraint&&(a=Shopify.queryParams.constraint.split("+")),r.find("input:checked").each((function(){var e=t(this).val();if(e){var i=a.indexOf(e);i>=0&&a.splice(i,1)}})),r.find("a").each((function(){t(this).removeClass("active")})),a.length?Shopify.queryParams.constraint=a.join("+"):delete Shopify.queryParams.constraint,e.filterAjaxClick(),i.preventDefault()}))},filterMapClear:function(){t(".filter-tag").each((function(){var e=t(this);e.find("input:checked").length>0&&e.find(".clear").show()}))},filterParams:function(){if(Shopify.queryParams={},location.search.length)for(var t,e=0,i=location.search.substr(1).split("&");e<i.length;e++)(t=i[e].split("=")).length>1&&(Shopify.queryParams[decodeURIComponent(t[0])]=decodeURIComponent(t[1]))},filterMapEvents:function(){e.fillterTagEvents()},resetFilter:function(){t(".filter-custom .active, .filter-links .active").removeClass("active"),t(".filter-tag input:checked").attr("checked",!1);var e=location.pathname.match(/\/collections\/(.*)(\?)?/);e&&e[1]&&t(".filter-links a[href='"+e[0]+"']").addClass("active")},filterMapData:function(i){var a=t(".product-collection-grid"),r=t(i).find(".product-collection-grid");a.replaceWith(r),t(".pagination").length>0&&t(".pagination").replaceWith(t(i).find(".pagination")),t(".filter-blocks").replaceWith(t(i).find(".filter-blocks")),e.filterMapClear()},filterCreateUrl:function(e){var i=t.param(Shopify.queryParams).replace(/%2B/g,"+");return e?""!=i?e+"?"+i:e:location.pathname+"?"+i},filterAjaxClick:function(t){delete Shopify.queryParams.page;var i=e.filterCreateUrl(t);e.fillterClick=!0,History.pushState({param:Shopify.queryParams},i,i),e.filterGetContent(i)},filterGetContent:function(i){t.ajax({type:"get",url:i,beforeSend:function(){showPopup(".loading")},success:function(t){e.filterMapData(t),e.filterMapClear(),hidePopup(".loading")},error:function(e,i){hidePopup(".loading"),t(".ajax-error-message").text(t.parseJSON(e.responseText).description),showPopup(".ajax-error-modal")}})},initCollectionFilter:function(){t(".engoj-collection-sidebar").length>0&&(e.filterParams(),e.filterMapEvents(),e.filterMapClear(),e.filterMapClearAll())},initCollectionSorting:function(i){t(".wrap-filter-sorting a").click((function(i){i.preventDefault(),t(this).parent().hasClass("active")||(Shopify.queryParams.sort_by=t(this).attr("href"),e.filterAjaxClick(),t(".wrap-filter-sorting li.active").removeClass("active"),t(this).parent().addClass("active"));var a=t(this).text();t(this).closest(".dropdown").find(".dropdown-label").text(a),t(this).closest(".dropdown-toggle").removeClass("active")}))},initCollectionViewMode:function(){},initCollectionShow:function(){t(".filter-show a").click((function(i){if(i.preventDefault(),!t(this).parent().hasClass("active")){var a=t(this).attr("href"),r=t(".button-view a.active").attr("data-mode");Shopify.queryParams.view="list"==r?"list"+a:a,e.filterAjaxClick(),t(".filter-show li.active").removeClass("active"),t(this).parent().addClass("active"),t(this).closest(".dropdown").find(".dropdown-label").text(a),t(this).closest(".dropdown-content").removeClass("active")}}))},initPaging:function(){}}}(jQuery);